;
; keys.inc
;
; Defines for key-codes
;
; TODO Is a delay needed?
;

#ifndef _KEYS_INC
#define _KEYS_INC

#include "utils.inc"

DEFINE_AND_MASK(KEY_GROUP1, 6)
DEFINE_AND_MASK(KEY_GROUP2, 5)
DEFINE_AND_MASK(KEY_GROUP3, 4)
DEFINE_AND_MASK(KEY_GROUP4, 3)
DEFINE_AND_MASK(KEY_GROUP5, 2)
DEFINE_AND_MASK(KEY_GROUP6, 1)
DEFINE_AND_MASK(KEY_GROUP7, 0)

KEY_GROUP_RESET .equ $FF
KEY_GROUP_COUNT .equ 7


; Group 1
DEFINE_AND_MASK(KEY_GRAPH,  0)
DEFINE_AND_MASK(KEY_TRACE,  1)
DEFINE_AND_MASK(KEY_ZOOM,   2)
DEFINE_AND_MASK(KEY_WINDOW, 3)
DEFINE_AND_MASK(KEY_Y_EQ,   4)
DEFINE_AND_MASK(KEY_2ND,    5)
DEFINE_AND_MASK(KEY_MODE,   6)
DEFINE_AND_MASK(KEY_DEL,    7)

; Group 2
DEFINE_AND_MASK(KEY_STO,    1)
DEFINE_AND_MASK(KEY_LN,     2)
DEFINE_AND_MASK(KEY_LOG,    3)
DEFINE_AND_MASK(KEY_X_2,    4)
DEFINE_AND_MASK(KEY_X_1,    5)
DEFINE_AND_MASK(KEY_MATH,   6)
DEFINE_AND_MASK(KEY_ALPHA,  7)

; Group 3
DEFINE_AND_MASK(KEY_0,      0)
DEFINE_AND_MASK(KEY_1,      1)
DEFINE_AND_MASK(KEY_4,      2)
DEFINE_AND_MASK(KEY_7,      3)
DEFINE_AND_MASK(KEY_COMMA,  4)
DEFINE_AND_MASK(KEY_SIN,    5)
DEFINE_AND_MASK(KEY_APPS,   6)
DEFINE_AND_MASK(KEY_XTON,   7)

; Group 4
DEFINE_AND_MASK(KEY_DOT,    0)
DEFINE_AND_MASK(KEY_2,      1)
DEFINE_AND_MASK(KEY_5,      2)
DEFINE_AND_MASK(KEY_8,      3)
DEFINE_AND_MASK(KEY_LPAREN, 4)
DEFINE_AND_MASK(KEY_COS,    5)
DEFINE_AND_MASK(KEY_PRGM,   6)
DEFINE_AND_MASK(KEY_STAT,   7)

; Group 5
DEFINE_AND_MASK(KEY_NEG,    0)
DEFINE_AND_MASK(KEY_3,      1)
DEFINE_AND_MASK(KEY_6,      2)
DEFINE_AND_MASK(KEY_9,      3)
DEFINE_AND_MASK(KEY_RPAREN, 4)
DEFINE_AND_MASK(KEY_TAN,    5)
DEFINE_AND_MASK(KEY_VARS,   6)

; Group 6
DEFINE_AND_MASK(KEY_ENTER,  0)
DEFINE_AND_MASK(KEY_ADD,    1)
DEFINE_AND_MASK(KEY_SUB,    2)
DEFINE_AND_MASK(KEY_MUL,    3)
DEFINE_AND_MASK(KEY_DIV,    4)
DEFINE_AND_MASK(KEY_EXPON,  5)
DEFINE_AND_MASK(KEY_CLEAR,  6)

; Group 7
DEFINE_AND_MASK(KEY_DOWN,   0)
DEFINE_AND_MASK(KEY_LEFT,   1)
DEFINE_AND_MASK(KEY_RIGHT,  2)
DEFINE_AND_MASK(KEY_UP,     3)

#macro KEY_SET_GROUP(G)
    ld a, $ff
    out (KEYPORT), a
    ld a, G
    out (KEYPORT), a
#endmacro

#macro KEY_IN()
    in a, (KEYPORT)
#endmacro

#macro KEY_IS_DOWN(G, K)
    SET_KEY_GROUP(G)
    GET_KEY()
    cp K
#endmacro

#endif ; _KEYS_INC

